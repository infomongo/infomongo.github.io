---
layout: default
title: 'Tip Calculator'
---

<div class="main big tip-calc">
	
	<p>Tip Calculator </p>

	<div class="line">
		$ <input id="bill" type="text" pattern="\d*" value="" class="large"><span class="label">bill amount</span>
	</div>
	
	<div class="line">
		$ <span id="tip">--</span>
		<span class="label">tip amount</span>
	</div>
	
	<div class="line">
		$ <span id="total">--</span>
		<span class="label">total</span>
	</div>

	<p id="percent"></p>

</div>


{% include copyright.html %}

<script src="/js/jquery-1.11.1.min.js"></script>

<script>

$(function() {
	 	 	
	var $bill = $('#bill');
	var $tip = $('#tip');
	var $total = $('#total');
	var $percent = $('#percent')
	
	$bill.on('keyup', function () {
	  format();
	  //calculate();
	});
	
	function format() {
		var bill = $bill.val();
		
		var pos = bill.indexOf(".");
		if (pos > 0){
			var n = bill.replace(".", "");
			bill = n;
			//console.log('strip . ' + bill);
		}
				
		if (bill.length > 2){
			var newBill = bill.slice(0, -2);
			var endBill = bill.slice(-2);
			bill = newBill + '.' + endBill;
			//console.log('newBill ' + newBill);
			//console.log('endBill ' + endBill);
			//console.log('bill ' + bill);
			var flag = 1 ;
		}
		
		if (flag) {
			$bill.val(bill);
			
		}
		calculate()
	}
	
	function calculate() {
		var percent = 0.2;
		var bill = Number($bill.val());
		var roundBill = Math.floor(bill);	
		var baseTip = (roundBill * percent);
		//console.log(typeof baseTip);
		
		var total = Math.ceil(bill + baseTip);
		var tip = total - bill ;
		var effectiveTip =  Math.round( (tip / bill) * 100 );
		
		
		if (effectiveTip > 20 && bill > 20 ) {
			if (tip > 1 ) tip = tip - 1;
			total = bill + tip;
			effectiveTip =  Math.round( (tip / bill) * 100 );
			var flag = 1;
			//console.log("> than 21% " + tip);
		}
		
		// if (flag = 1 && effectiveTip < 16 ) {
		// 	tip = tip + .5;
		// 	total = bill + tip;
		// 	effectiveTip =  Math.round( (tip / bill) * 100 );
		// }
		
		tip = cleanForDisplay(tip);
		total = cleanForDisplay(total);
		
		$tip.html(tip);
		$total.html(total);
		if (effectiveTip) {
			$percent.html(effectiveTip + "%" );
		}
	}
	 
	function cleanForDisplay(num) {
		var cleaned = parseFloat(Math.round(num * 100) / 100).toFixed(2)
		return cleaned;
	}
	
});

</script>
